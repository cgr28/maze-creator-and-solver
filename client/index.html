<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <link rel="shortcut icon" href="./icon.svg" type="image/x-icon" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
            integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
            crossorigin="anonymous"
        />
        <link rel="stylesheet" href="style.css" />
        <title>Maze Creator and Solver</title>
    </head>
    <body>
        <nav class="navbar">
            <div class="container-fluid">
                <a class="navbar-brand">Maze Creator and Solver</a>
                <div class="navbar-nav">
                    <a
                        class="nav-link"
                        href="https://github.com/cgr28/maze-creator-and-solver"
                        target="_blank"
                        >Github</a
                    >
                    <a
                        class="nav-link"
                        href="https://www.linkedin.com/in/colbe/"
                        target="_blank"
                        >LinkedIn</a
                    >
                </div>
            </div>
        </nav>
        <div class="container mt-5">
            <p class="header">Maze generator algorithm</p>
            <input
                id="hunt-and-kill"
                name="creator"
                type="radio"
                value="hunt-and-kill"
                checked
            />
            <label for="hunt-and-kill">Hunt and Kill</label>
            <input
                id="growing-tree"
                name="creator"
                type="radio"
                value="growing-tree"
            />
            <label for="growing-tree">Growing Tree</label>
            <input id="prims" name="creator" type="radio" value="prims" />
            <label for="prims">Prims</label>
            <br />
            <p class="header mt-4">Maze solver algorithm</p>
            <input
                id="breadth-first-search"
                name="solver"
                type="radio"
                value="breadth-first-search"
                checked
            />
            <label for="breadth-first-search">Breadth First Search</label>
            <input
                id="depth-first-search"
                name="solver"
                type="radio"
                value="depth-first-search"
            />
            <label for="depth-first-search">Depth First Search</label>
            <input
                id="best-first-search"
                name="solver"
                type="radio"
                value="best-first-search"
            />
            <label for="best-first-search">Best First Search</label>
            <input id="a-star" name="solver" type="radio" value="a-star" />
            <label for="a-star">A-Star</label>
            <input id="none" name="solver" type="radio" value="none" />
            <label for="none">None</label>
            <br />
            <p class="header mt-4">Customize maze</p>
            <input
                type="number"
                min="5"
                max="100"
                value="20"
                class="slider"
                id="size"
            />
            <label for="size" id="slider-label">Size (min: 5, max: 100)</label>
            <input
                type="checkbox"
                id="visited"
                name="visited"
                value="True"
                checked
            />
            <label for="Visited">Visited Cells</label>
            <br />
            <button id="generate" class="mt-4" onclick="userAction()">
                Generate Maze
            </button>
            <div class="mt-5" id="stats"></div>
            <div class="mt-5 mb-4" id="maze-container">
                Click the button to generate a maze.
            </div>
        </div>
    </body>
    <script>
        const slider = document.querySelector("#size");
        const label = document.querySelector("#slider-label");
        const mazeContainer = document.querySelector("#maze-container");
        const stats = document.querySelector("#stats");
        const vis = document.querySelector("#visited");
        const btn = document.querySelector("#generate");

        const getSelectedRadio = (buttonName) => {
            var elems = document.getElementsByName(buttonName);
            for (i = 0; i < elems.length; i++) {
                if (elems[i].checked) {
                    return elems[i].value;
                }
            }
            return null;
        };

        const userAction = async () => {
            btn.disabled = true;
            mazeContainer.innerHTML =
                "<div class='spinner-border' role='status'></div>";
            var creatorType = getSelectedRadio("creator");
            var solverType = getSelectedRadio("solver");
            if (vis.checked) {
                var visType = 1;
            } else {
                var visType = 0;
            }
            const res = await fetch(
                `/api/${creatorType}/${slider.value}/${solverType}/${visType}`
            );
            const mazeInfo = await res.json();
            mazeContainer.innerHTML = mazeInfo.maze;
            stats.innerHTML = `<p>Total cells in maze:
                                    ${mazeInfo.num_of_cells}
                                </p>
                                <p>Total cells visited by solver:
                                    ${mazeInfo.visited_cells}
                                </p>
                                <p>Total length of solution:
                                    ${mazeInfo.solution_length}
                                </p>`;

            document.querySelector("svg").style.width = slider.value * 5;
            document.querySelector("svg").style.height = slider.value * 5;
            btn.disabled = false;
        };
    </script>
</html>
